% NOTE: Explain the concepts for someone who has background in cs but not in the exact field
\section{Background}
\label{cha:background}

\subsection{Spatiotemporal Data and Queries}
% NOTE: Spatiotemporal data
Spatiotemporal data contains spatial (location-based) and temporal (time-based) aspects.
Geographic coordinates are a common way to make data geo-referenced, and a timestamp is often used as a temporal tag. \cite{alamSurveySpatiotemporalData2022}

Furthermore, two types of spatiotemporal data can be distinguished.
Stationary data refers to objects that do not change their position over time, such as weather stations and stationary sensors.
Moving (dynamic) data refers to objects that change their position over time, such as vehicles, people, or animals.

% NOTE: Spatiotemporal queries
There are many types of queries that can be performed on spatiotemporal data, here is the list of a common ones.
\begin{itemize}
	\item \textbf{Spatiotemporal Range Query:} Retrieves objects or events that occurred within a specific geographic area during a defined time window.
		e.g. Find all vehicles that were in Berlin between 7:00 and 9:00 on Friday, June 6, 2025.

	\item \textbf{Time Slice Query:} Retrieve all objects that are in a specific spatial area at a single point in time.
		e.g. Find all buses that were in Warsaw in Wola district center at 15:00 on Tuesday, July 23, 2025.

	\item \textbf{Window Queries:} Retrieve all objects that intersect a spatial area during a given time window.
		e.g. Find all trains that passed through Berlin Central Station between 10:00 and 12:00 on Wednesday, May 4, 2025. 

	\item \textbf{Trajectory Query:} Extracts or analyzes the movement path of an object over time.
		e.g. Show the movement path of a delivery drone as it traveled across Hamburg between 10:00 and 11:00 on Monday, June 2, 2025.

	\item \textbf{Spatiotemporal Join:} Identifies pairs of objects that came into spatial proximity during overlapping time intervals.
		e.g. Identify all pairs of taxis that came within 10 meters of each other between 16:00 and 20:00 on Friday night, June 6, 2025. 

	\item \textbf{k-Nearest Neighbor:} Finds the closest objects to a given location at a specific time or within a time window.
		e.g. List the five ambulances that were closest to the intersection of Friedrichstraße and Unter den Linden in Berlin at 14:35 on Thursday, June 5, 2025.
\end{itemize}

\subsection{Distributed Database Management Systems (DDBMS)}
% NOTE: distributed systems and challenges of them
Distributed Database Management Systems (DDBMS) are systems in which the database is distributed across multiple physical locations, often connected via a network.
These locations can be on different servers, in different data centers, or even across different geographic regions.
The primary goal of a DDBMS is to manage a distributed database in such a way that it appears to the user as a single logical database, hiding the complexities of data distribution and replication.

\subsection{Challanges in Distributed Systems}
Distributed systems, including DDBMSs, face several inherent challenges:
\begin{itemize}
	\item \textbf{Network Latency:} Communication between nodes in a distributed system is significantly slower than accessing local memory or storage.
		This delay can affect query performance and data synchronization.

	\item \textbf{Data Consistency:} Ensuring that all nodes reflect the same data at the same time is difficult, especially in the presence of updates.
		Different consistency models (such as eventual consistency or strong consistency) are used depending on the application requirements.

	\item \textbf{Availability:} A highly available system must respond to requests even if some parts of the system are down.
		Maintaining availability while ensuring consistency can be challenging.

	\item \textbf{Partition Tolerance:} This refers to a system's ability to continue operating even when network partitions occur—i.e., when communication between some nodes fails.
		The CAP theorem (discussed below) emphasizes the trade-offs among consistency, availability, and partition tolerance.

	\item \textbf{Fault Tolerance:} Distributed systems must be resilient to hardware failures, crashes, and other unexpected issues.
		Mechanisms such as replication and failover are often used to ensure data is not lost and services continue to function.
\end{itemize}

\subsubsection{CAP Theorem}
A central concept in understanding distributed databases is the CAP theorem, which states that a distributed system can guarantee only two of the following three properties at the same time:

\begin{itemize}
	\item \textbf{Consistency (C):} Every read receives the most recent write or an error.
	\item \textbf{Availability (A):} Every request receives a (non-error) response, without the guarantee that it contains the most recent write.
	\item \textbf{Partition Tolerance (P):} The system continues to operate despite arbitrary message loss or failure of part of the system.
\end{itemize}

Due to the CAP theorem, distributed databases must make design trade-offs based on the requirements of the application they serve.

\subsubsection{Handling Challenges in Different DDBMSs}
Different distributed databases such as \mobilitydbc~and CrateDB handle these challenges in different ways.

\textbf{MobilityDB} is an extension of PostgreSQL that supports spatiotemporal data types and queries, commonly used in mobility and geographic information systems (GIS).
To achieve scalability and distribution, it can be combined with Citus, a PostgreSQL extension that enables horizontal scaling through sharding and distributed query execution.
Since MobilityDB is built on PostgreSQL and uses Citus for distribution, it maintains strong consistency and full ACID compliance.
This is ideal for applications where data correctness and transactional integrity are critical.

\textbf{CrateDB} is a distributed SQL database designed for high ingest rates and real-time analytics over large-scale time-series and machine data.
It is based on shared-nothing architecture using Elasticsearch and Lucene under the hood.
CrateDB uses a distributed eventual consistency model, meaning data written to one node may take time to propagate to others.
It relaxes ACID constraints to gain performance and scalability, making it less suitable for applications requiring strict consistency.

% NOTE: Comparison of MobilityDB and CrateDB
% Citations for the support of the queries: https://www.perplexity.ai/search/which-of-these-queries-is-supp-n5CXpQokRBW2lIHKPA0yLg
Additionally, the differences between \mobilitydbc~and CrateDB can be seen by the available complex queries in \mobilitydbc~compared to the possibilities of CrateDB.
\mobilitydbc~has comprehensive support for spatiotemporal queries, including complex queries such as spatiotemporal joins and k-nearest neighbor queries \cite{bakliDistributedSpatiotemporalTrajectory2020,QueryingDataMobilitydbDocs}.
On the other hand CrateDB focuses on the real-time analytics and horizontal scalability, which makes it a better solution for IoT devices and real-time analytics \cite{CrateDBDocumentation}.
The table \ref{tab:mobilitydb_vs_cratedb} shows the differences between \mobilitydbc~and CrateDB and the queries the systems support.
\begin{table}[h]
  \centering
  \begin{tabular}{|P{3.3cm}|P{6cm}|P{4cm}|}
    \hline
    Category & \mobilitydbc~& CrateDB \\
    \hline
    Open source & Yes & Yes \\
    \hline
	Maintained by & 
		PostgreSQL Global Development Group,
		Citus Data team (now part of Microsoft),
		MobilityDB Community, and OSGeo community
	 & Crate.io \\
    \hline
    Consistency & Full ACID compliance & Eventual Consistancy \\
    \hline
    Supports SQL Queries & Yes & Yes \\
    \hline
    License & OSI-approved open source license similar to the BSD or MIT licenses & Apache 2.0 \\
    \hline
	% Supported spatiotemporal types & tgeompoint / tgeogpoint & geo\_point / geo\_shape (geospatial data) + time series (combined modeling) \\
	Supports spatiotemporal datatypes & Yes, builtin datatypes & Yes, geospatial data + time series (combined modeling) \\
	\hline
	Spatiotemporal Range Query & Yes & Partial (no native spatiotemporal types) \\
	\hline
	Time Slice Query & Yes & Yes \\
    \hline
	Window Queries & Yes & Yes \\
    \hline
	Trajectory Query & Yes & No \\
    \hline
	Spatiotemporal Join & Yes & Partial \\
    \hline
	k-Nearest Neighbor & Partial (spatial, some temporal) & Partial (spatial/vector, not spatiotemporal) \\
    \hline
  \end{tabular}
  \caption{Table comparing MobilityDB and CrateDB}
  \label{tab:mobilitydb_vs_cratedb}
\end{table}

We designed a benchmark by using feature set supported by both database systems.
